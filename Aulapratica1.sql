create schema pratica1 default character set utf8 collate utf8_unicode_ci;
create database pratica1;
use pratica1;



insert into
	pratica1.vendas
    (ID_NF, ID_ITEM, COD_PROD, VALOR_UNIT, QUANTIDADE, DESCONTO)
VALUES
(1,1,1,25,10,5),
(1,2,2,13.5,3,null),
(1,3,3,15,2,null),
(1,4,4,10,1,null),
(1,5,5,30,1,null),
(2,1,3,15,4,null),
(2,2,4,10,5,null),
(2,3,5,30,7,null),
(3,1,1,25,5,null),
(3,2,4,10,4,null),
(3,3,5,30,5,null),
(3,4,2,13.5,7,null),
(4,1,5,30,10,15),
(4,2,4,10,12,5),
(4,3,1,25,13,5),
(4,4,2,13.5,15,5),
(5,1,3,15,3,null),
(5,2,5,30,6,null),
(6,1,1,25,22,15),
(6,2,3,15,25,20),
(7,1,1,25,10,3),
(7,2,2,13.5,10,4),
(7,3,3,15,10,4),
(7,4,5,30,10,1);

SELECT 
	ID_NF, ID_ITEM, COD_PROD, VALOR_UNIT,
    (VALOR_UNIT=(VALOR_UNIT*(DESCONTO/100) ) ) as VALOR_VENDIDO
    FROM vendas;    

set sql_safe_updates = 0;


update vendas set DESCONTO = 0 where DESCONTO is null;

SELECT ID_NF,ID_ITEM,COD_PROD,VALOR_UNIT
(VALOR_UNIT-(VALOR_UNIT*(DESCONTO/100))) AS VALOR_VENDIDO FROM VENDAS ORDER BY ID_NF, COD_PROD;

SELECT ID_NF,ID_ITEM,COD_PROD,VALOR_UNIT,QUANTIDADE,DESCONTO,(QUANTIDADE*VALOR_UNIT)VALOR_TOTAL,
(VALOR_UNIT-(VALOR_UNIT*(DESCONTO/100))) AS VALOR_VENDIDO FROM VENDAS ORDER BY ID_NF, COD_PROD;

SELECT ID-NF (SUM(QUANTIDADE)*VALOR_UNIT) VALOR_TOTAL FROM VENDAS GROUP BY ID_NF
ORDER BY 2 DESC;


select ID_NF, (VALOR_UNIT-(VALOR_*(DESCONTO/100))) VALOR_VENDIDO FROM VENDAS
ORDER BY VALOR_VENDIDO DESC;
 
 #G
 SELECT COD_PROD, MAX(QUANTIDADE) QUANTIDADE FROM VENDAS; 
 
 #H
 SELECT ID_N, COD_PROD, QUANTIDADE FROM VENDAS WHERE QUANTIDADE >10;
 
 #I
 SELECT ID_NF, SUM(QUANTIDADE)*VALOR_UNIT AS VALOR_TOTAL FROM VENDAS GROUP BY ID_NF
 HAVING NVALOR_TOTAL>500 ORDER BY 2 DESC;
 
 #J
 SELECT COD_PROD, ROUND(AVG(DESCONTO),2) MEDIA FROM VENDAS GROUP BY COD_PROD ORDER BY MEDIA ASC;
 
 
 #K
 
 SELECT ID_PROD, MENOR
 
 

 




